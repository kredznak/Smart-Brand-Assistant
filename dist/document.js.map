{"version":3,"file":"document.js","sources":["../src/samples/templates.ts","../src/editor/applyBrandKit.ts","../src/document.ts"],"sourcesContent":["export type TemplateDef = {\n  id: string;\n  name: string;\n  width: number;\n  height: number;\n  safeZone?: { x: number; y: number; width: number; height: number };\n};\n\nexport const moodTemplates: TemplateDef[] = [\n  { id: 'ig-post', name: 'IG Post', width: 1080, height: 1080, safeZone: { x: 60, y: 60, width: 960, height: 960 } },\n  { id: 'ig-story', name: 'IG Story', width: 1080, height: 1920, safeZone: { x: 60, y: 200, width: 960, height: 1520 } },\n  { id: 'flyer', name: 'Flyer', width: 816, height: 1056, safeZone: { x: 48, y: 48, width: 720, height: 960 } },\n  { id: 'email-header', name: 'Email Header', width: 1200, height: 400, safeZone: { x: 40, y: 40, width: 1120, height: 320 } },\n  { id: 'presentation', name: 'Presentation', width: 1920, height: 1080, safeZone: { x: 80, y: 80, width: 1760, height: 920 } }\n];\n\n","import { type BrandKit } from '../state/types.js';\nimport { moodTemplates } from '../samples/templates.js';\n\nexport async function applyBrandKitToDocument(kit: BrandKit, _opts: { targets: 'all' }): Promise<void> {\n  // If running inside Adobe Express Playground with Document APIs available, attempt to apply.\n  // Reference: https://developer.adobe.com/express-add-on-apis/docs/\n  const anyWindow = window as any;\n  const docApi = anyWindow?.express?.document;\n  if (docApi?.transaction) {\n    await docApi.transaction(async () => {\n      // Update document-level theme variables (pseudo API)\n      if (docApi.setThemeVariables) {\n        const vars: Record<string, string> = {};\n        for (const p of kit.palette) vars[`--sba-${p.role}`] = p.hex;\n        await docApi.setThemeVariables(vars);\n      }\n      // Apply to text styles where available\n      if (docApi.queryTextNodes && docApi.setTextStyle) {\n        const textNodes = await docApi.queryTextNodes({ all: true });\n        for (const node of textNodes) {\n          await docApi.setTextStyle(node, { fontFamily: kit.fonts.primary.family });\n        }\n      }\n      // Place logo in safe zone of detected template canvas\n      if (kit.logo?.url && docApi.placeImage && docApi.getCanvasSize) {\n        const { width, height } = await docApi.getCanvasSize();\n        const tmpl = moodTemplates.find(t => t.width === width && t.height === height);\n        const zone = tmpl?.safeZone ?? { x: width * 0.05, y: height * 0.05, width: width * 0.3, height: height * 0.15 };\n        await docApi.placeImage(kit.logo.url, { x: zone.x, y: zone.y, width: zone.width, height: zone.height });\n      }\n    });\n    return;\n  }\n  // Fallback: no-op with delay to simulate apply\n  console.log('Applying Brand Kit to document (stub)', kit);\n  await new Promise(r => setTimeout(r, 300));\n}\n\n","import { applyBrandKitToDocument } from './editor/applyBrandKit.js';\nimport { type BrandKit } from './state/types.js';\n\n// Document-side message handling (runs in editor context in Playground)\nwindow.addEventListener('message', async (ev: MessageEvent) => {\n  const data = ev.data;\n  if (!data || typeof data !== 'object') return;\n  if (data.type === 'SBA_APPLY_BRAND_KIT') {\n    const kit: BrandKit = data.payload;\n    try {\n      await applyBrandKitToDocument(kit, { targets: 'all' });\n      window.parent.postMessage({ type: 'SBA_APPLY_DONE', correlationId: data.correlationId }, '*');\n    } catch (e) {\n      console.error(e);\n      window.parent.postMessage({ type: 'SBA_APPLY_ERROR', error: (e as Error).message, correlationId: data.correlationId }, '*');\n    }\n  }\n});\n\n"],"names":["moodTemplates","applyBrandKitToDocument","kit","_opts","docApi","vars","p","textNodes","node","width","height","zone","t","r","ev","data"],"mappings":"AAQO,MAAMA,EAA+B,CAC1C,CAAE,GAAI,UAAW,KAAM,UAAW,MAAO,KAAM,OAAQ,KAAM,SAAU,CAAE,EAAG,GAAI,EAAG,GAAI,MAAO,IAAK,OAAQ,IAAI,EAC/G,CAAE,GAAI,WAAY,KAAM,WAAY,MAAO,KAAM,OAAQ,KAAM,SAAU,CAAE,EAAG,GAAI,EAAG,IAAK,MAAO,IAAK,OAAQ,KAAK,EACnH,CAAE,GAAI,QAAS,KAAM,QAAS,MAAO,IAAK,OAAQ,KAAM,SAAU,CAAE,EAAG,GAAI,EAAG,GAAI,MAAO,IAAK,OAAQ,IAAI,EAC1G,CAAE,GAAI,eAAgB,KAAM,eAAgB,MAAO,KAAM,OAAQ,IAAK,SAAU,CAAE,EAAG,GAAI,EAAG,GAAI,MAAO,KAAM,OAAQ,IAAI,EACzH,CAAE,GAAI,eAAgB,KAAM,eAAgB,MAAO,KAAM,OAAQ,KAAM,SAAU,CAAE,EAAG,GAAI,EAAG,GAAI,MAAO,KAAM,OAAQ,IAAI,CAC5H,ECXA,eAAsBC,EAAwBC,EAAeC,EAA0C,CAIrG,MAAMC,EADY,QACQ,SAAS,SACnC,GAAIA,GAAQ,YAAa,CACvB,MAAMA,EAAO,YAAY,SAAY,CAEnC,GAAIA,EAAO,kBAAmB,CAC5B,MAAMC,EAA+B,CAAA,EACrC,UAAWC,KAAKJ,EAAI,QAASG,EAAK,SAASC,EAAE,IAAI,EAAE,EAAIA,EAAE,IACzD,MAAMF,EAAO,kBAAkBC,CAAI,CACrC,CAEA,GAAID,EAAO,gBAAkBA,EAAO,aAAc,CAChD,MAAMG,EAAY,MAAMH,EAAO,eAAe,CAAE,IAAK,GAAM,EAC3D,UAAWI,KAAQD,EACjB,MAAMH,EAAO,aAAaI,EAAM,CAAE,WAAYN,EAAI,MAAM,QAAQ,OAAQ,CAE5E,CAEA,GAAIA,EAAI,MAAM,KAAOE,EAAO,YAAcA,EAAO,cAAe,CAC9D,KAAM,CAAE,MAAAK,EAAO,OAAAC,CAAA,EAAW,MAAMN,EAAO,cAAA,EAEjCO,EADOX,EAAc,KAAKY,GAAKA,EAAE,QAAUH,GAASG,EAAE,SAAWF,CAAM,GAC1D,UAAY,CAAE,EAAGD,EAAQ,IAAM,EAAGC,EAAS,IAAM,MAAOD,EAAQ,GAAK,OAAQC,EAAS,GAAA,EACzG,MAAMN,EAAO,WAAWF,EAAI,KAAK,IAAK,CAAE,EAAGS,EAAK,EAAG,EAAGA,EAAK,EAAG,MAAOA,EAAK,MAAO,OAAQA,EAAK,OAAQ,CACxG,CACF,CAAC,EACD,MACF,CAEA,QAAQ,IAAI,wCAAyCT,CAAG,EACxD,MAAM,IAAI,QAAQW,GAAK,WAAWA,EAAG,GAAG,CAAC,CAC3C,CChCA,OAAO,iBAAiB,UAAW,MAAOC,GAAqB,CAC7D,MAAMC,EAAOD,EAAG,KAChB,GAAI,GAACC,GAAQ,OAAOA,GAAS,WACzBA,EAAK,OAAS,sBAAuB,CACvC,MAAMb,EAAgBa,EAAK,QAC3B,GAAI,CACF,MAAMd,EAAwBC,EAAK,CAAE,QAAS,MAAO,EACrD,OAAO,OAAO,YAAY,CAAE,KAAM,iBAAkB,cAAea,EAAK,aAAA,EAAiB,GAAG,CAC9F,OAAS,EAAG,CACV,QAAQ,MAAM,CAAC,EACf,OAAO,OAAO,YAAY,CAAE,KAAM,kBAAmB,MAAQ,EAAY,QAAS,cAAeA,EAAK,aAAA,EAAiB,GAAG,CAC5H,CACF,CACF,CAAC"}