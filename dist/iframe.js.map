{"version":3,"file":"iframe.js","sources":["../src/sdk/ui.ts","../src/analysis/color/extract.ts","../src/analysis/font/identify.ts","../src/analysis/tone/map.ts","../src/accessibility/wcag.ts","../src/ui/panels/a11y.ts","../src/ui/panels/preview.ts","../src/ui/app.ts","../src/iframe.ts"],"sourcesContent":["export function initializeThemeSync(): void {\n  // In real Add-on, subscribe to Adobe UI SDK theme signals; here mirror prefers-color-scheme\n  const mq = window.matchMedia('(prefers-color-scheme: dark)');\n  function applyTheme(dark: boolean) {\n    const html = document.documentElement;\n    html.classList.toggle('spectrum--dark', dark);\n    html.classList.toggle('spectrum--light', !dark);\n  }\n  applyTheme(mq.matches);\n  mq.addEventListener('change', e => applyTheme(e.matches));\n}\n\nexport async function requestDocumentApply(kit: unknown): Promise<void> {\n  const correlationId = typeof crypto !== 'undefined' && 'randomUUID' in crypto\n    ? (crypto as any).randomUUID()\n    : `${Date.now()}-${Math.random().toString(16).slice(2)}`;\n  return new Promise((resolve, reject) => {\n    function onMessage(ev: MessageEvent) {\n      const data = ev.data;\n      if (!data || typeof data !== 'object') return;\n      if (data.correlationId !== correlationId) return;\n      if (data.type === 'SBA_APPLY_DONE') {\n        window.removeEventListener('message', onMessage);\n        resolve();\n      } else if (data.type === 'SBA_APPLY_ERROR') {\n        window.removeEventListener('message', onMessage);\n        reject(new Error(String(data.error)));\n      }\n    }\n    window.addEventListener('message', onMessage);\n    window.parent.postMessage({ type: 'SBA_APPLY_BRAND_KIT', payload: kit, correlationId }, '*');\n  });\n}\n\n","import { type PaletteEntry } from '../../state/types.js';\n\ntype Input = { imageDataUrl: string | null; url: string | null };\n\nexport async function extractPalette(input: Input): Promise<PaletteEntry[]> {\n  // Prefer server adapter when URL available; otherwise local fallback\n  if (input.url) {\n    try {\n      const resp = await fetch('/api/analyze/colors', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ imageUrl: input.url }) });\n      const data = await resp.json();\n      if (Array.isArray(data.swatches)) return normalizeRoles(data.swatches);\n    } catch {}\n  }\n  // Simple local fallback: sample fixed palette\n  return normalizeRoles([\n    { name: 'Primary', hex: '#0A84FF', role: 'primary' },\n    { name: 'Secondary', hex: '#34C759', role: 'secondary' },\n    { name: 'Accent', hex: '#FF9500', role: 'accent' },\n    { name: 'Background', hex: '#FFFFFF', role: 'bg' },\n    { name: 'Surface', hex: '#F2F2F7', role: 'surface' },\n    { name: 'Text', hex: '#111111', role: 'text' }\n  ]);\n}\n\nfunction normalizeRoles(swatches: any[]): PaletteEntry[] {\n  const roles: Array<PaletteEntry['role']> = ['primary', 'secondary', 'accent', 'bg', 'surface', 'text'];\n  return swatches.slice(0, 8).map((s, i) => ({\n    name: String(s.name ?? `Color ${i+1}`),\n    hex: String(s.hex ?? s.color ?? '#888888').toUpperCase(),\n    role: (s.role ?? roles[Math.min(i, roles.length - 1)])\n  }));\n}\n\n","import { type FontRef } from '../../state/types.js';\n\ntype Input = { imageDataUrl: string | null; url: string | null };\n\nexport async function identifyFonts(_input: Input): Promise<{ primary: FontRef; secondary?: FontRef }> {\n  // Try server adapter (Google Fonts fallback)\n  try {\n    const resp = await fetch('/api/analyze/fonts', { method: 'POST' });\n    const data = await resp.json();\n    if (data?.primary) return { primary: data.primary as FontRef, secondary: data.options?.[1] };\n  } catch {}\n  // Local fallback\n  return { primary: { family: 'Inter', source: 'google-fonts', weights: [400, 600] }, secondary: { family: 'Roboto', source: 'google-fonts', weights: [400, 700] } };\n}\n\n","export type Tone = 'friendly' | 'bold' | 'minimal' | 'playful' | 'professional';\n\nexport async function inferTone(_input: { url: string | null; handle: string | null }): Promise<Tone> {\n  // Call server for tone; if fails, fallback heuristic to 'friendly'\n  try {\n    const r = await fetch('/api/analyze/tone', { method: 'POST' });\n    const data = await r.json();\n    return normalizeTone(String(data?.tone ?? 'friendly'));\n  } catch {\n    return 'friendly';\n  }\n}\n\nexport function mapToneToStyle(tone: Tone): {\n  corners: 'rounded' | 'sharp';\n  contrast: 'high' | 'medium' | 'low';\n  spacing: 'comfortable' | 'compact' | 'loose';\n} {\n  switch (tone) {\n    case 'bold':\n      return { corners: 'sharp', contrast: 'high', spacing: 'compact' };\n    case 'minimal':\n      return { corners: 'sharp', contrast: 'medium', spacing: 'comfortable' };\n    case 'playful':\n      return { corners: 'rounded', contrast: 'medium', spacing: 'loose' };\n    case 'professional':\n      return { corners: 'sharp', contrast: 'high', spacing: 'comfortable' };\n    case 'friendly':\n    default:\n      return { corners: 'rounded', contrast: 'medium', spacing: 'comfortable' };\n  }\n}\n\nfunction normalizeTone(v: string): Tone {\n  const map: Record<string, Tone> = { friendly: 'friendly', bold: 'bold', minimal: 'minimal', playful: 'playful', professional: 'professional' };\n  return map[v.toLowerCase()] ?? 'friendly';\n}\n\n","import { type Hex } from '../state/types.js';\n\nexport function contrastRatio(hexA: Hex, hexB: Hex): number {\n  const L1 = relativeLuminance(hexToRgb(hexA));\n  const L2 = relativeLuminance(hexToRgb(hexB));\n  const [lighter, darker] = L1 > L2 ? [L1, L2] : [L2, L1];\n  return (lighter + 0.05) / (darker + 0.05);\n}\n\nexport function ensureAA(fg: Hex, bg: Hex): { fg: Hex; bg: Hex; passes: boolean } {\n  const ratio = contrastRatio(fg, bg);\n  if (ratio >= 4.5) return { fg, bg, passes: true };\n  // Simple adjustment: tweak lightness of fg towards max contrast\n  const fgRgb = hexToRgb(fg);\n  const bgRgb = hexToRgb(bg);\n  const fgIsLight = relativeLuminance(fgRgb) > relativeLuminance(bgRgb);\n  let adjusted = fgRgb;\n  for (let i = 0; i < 20 && contrastRatio(rgbToHex(adjusted), bg) < 4.5; i++) {\n    adjusted = fgIsLight ? darken(adjusted, 0.06) : lighten(adjusted, 0.06);\n  }\n  return { fg: rgbToHex(adjusted), bg, passes: contrastRatio(rgbToHex(adjusted), bg) >= 4.5 };\n}\n\nexport function hexToRgb(hex: Hex): { r: number; g: number; b: number } {\n  const h = hex.replace('#', '');\n  const v = h.length === 3 ? h.split('').map(c => c + c).join('') : h;\n  const num = parseInt(v, 16);\n  return { r: (num >> 16) & 255, g: (num >> 8) & 255, b: num & 255 };\n}\n\nexport function rgbToHex(rgb: { r: number; g: number; b: number }): Hex {\n  const toHex = (n: number) => n.toString(16).padStart(2, '0');\n  return `#${toHex(clamp(rgb.r))}${toHex(clamp(rgb.g))}${toHex(clamp(rgb.b))}`.toUpperCase();\n}\n\nfunction clamp(n: number): number { return Math.max(0, Math.min(255, Math.round(n))); }\n\nfunction relativeLuminance({ r, g, b }: { r: number; g: number; b: number }): number {\n  const srgb = [r, g, b].map(v => v / 255).map(v => (v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)));\n  const [R, G, B] = srgb;\n  return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n}\n\nfunction lighten(rgb: { r: number; g: number; b: number }, amt: number) {\n  return { r: rgb.r + 255 * amt, g: rgb.g + 255 * amt, b: rgb.b + 255 * amt };\n}\n\nfunction darken(rgb: { r: number; g: number; b: number }, amt: number) {\n  return { r: rgb.r - 255 * amt, g: rgb.g - 255 * amt, b: rgb.b - 255 * amt };\n}\n\n","import { type BrandKit } from '../../state/types.js';\nimport { contrastRatio, ensureAA } from '../../accessibility/wcag.js';\n\nexport function buildA11yPanel(kit: BrandKit): HTMLElement {\n  const container = document.createElement('div');\n  container.className = 'sba-col';\n  const table = document.createElement('table');\n  table.className = 'spectrum-Table';\n  const header = document.createElement('tr');\n  header.innerHTML = '<th>Foreground</th><th>Background</th><th>Ratio</th><th>AA</th><th>AAA</th><th>Suggestion</th>';\n  table.appendChild(header);\n\n  const textColors = kit.palette.filter(p => ['text', 'primary', 'secondary'].includes(p.role));\n  const bgColors = kit.palette.filter(p => ['bg', 'surface', 'primary', 'secondary'].includes(p.role));\n  for (const fg of textColors) {\n    for (const bg of bgColors) {\n      const ratio = contrastRatio(fg.hex, bg.hex);\n      const tr = document.createElement('tr');\n      const aa = ratio >= 4.5;\n      const aaa = ratio >= 7;\n      let suggestion = '';\n      if (!aa) {\n        const adj = ensureAA(fg.hex, bg.hex);\n        suggestion = `${adj.fg} / ${adj.bg}`;\n      }\n      tr.innerHTML = `<td><span class=\"swatch\" style=\"background:${fg.hex}\"></span> ${fg.hex}</td><td><span class=\"swatch\" style=\"background:${bg.hex}\"></span> ${bg.hex}</td><td>${ratio.toFixed(2)}</td><td>${aa ? 'Pass' : 'Fail'}</td><td>${aaa ? 'Pass' : 'â€”'}</td><td>${suggestion}</td>`;\n      table.appendChild(tr);\n    }\n  }\n  container.appendChild(table);\n  return container;\n}\n\n","import { type BrandKit } from '../../state/types.js';\n\nexport function createPreviews(kit: BrandKit): HTMLDivElement[] {\n  const sizes = [\n    { name: 'IG Post', w: 1080, h: 1080 },\n    { name: 'IG Story', w: 1080, h: 1920 },\n    { name: 'Flyer', w: 816, h: 1056 }, // US Letter @ 72dpi\n    { name: 'Email Header', w: 1200, h: 400 },\n    { name: 'Presentation', w: 1920, h: 1080 }\n  ];\n  const primary = kit.palette.find(p => p.role === 'primary')?.hex ?? '#0A84FF';\n  const text = kit.palette.find(p => p.role === 'text')?.hex ?? '#111111';\n  return sizes.map(size => {\n    const el = document.createElement('div');\n    el.className = 'sba-col';\n    el.style.border = '1px solid var(--spectrum-global-color-gray-300)';\n    el.style.padding = '8px';\n    el.innerHTML = `<div style=\"width:100%; aspect-ratio:${size.w}/${size.h}; background:${primary}; color:${text}; display:flex; align-items:center; justify-content:center; font-family:${kit.fonts.primary.family}\">${size.name}</div>`;\n    const openBtn = document.createElement('button');\n    openBtn.className = 'spectrum-Button';\n    openBtn.innerHTML = '<span class=\"spectrum-Button-label\">Open in Editor</span>';\n    openBtn.addEventListener('click', () => {\n      // In a real integration, call Document APIs to instantiate template\n      window.alert(`${size.name} would open in the editor.`);\n    });\n    el.appendChild(openBtn);\n    return el;\n  });\n}\n\n","import { type AnalysisInput, type BrandKit, type PaletteEntry, type FontRef } from '../state/types.js';\nimport { extractPalette } from '../analysis/color/extract.js';\nimport { identifyFonts } from '../analysis/font/identify.js';\nimport { inferTone, mapToneToStyle } from '../analysis/tone/map.js';\nimport { buildA11yPanel } from './panels/a11y.js';\nimport { createPreviews } from './panels/preview.js';\n\nexport async function analyzeBrandInputs(input: AnalysisInput): Promise<{ kit: BrandKit; renders: { previews: HTMLDivElement[]; a11y: HTMLElement } }>\n{\n  const onProgress = input.onProgress ?? (() => {});\n  onProgress(10);\n\n  // Derive candidate image URL or blob\n  let imageDataUrl: string | null = null;\n  if (input.file) {\n    imageDataUrl = await fileToDataUrl(input.file);\n  } else if (input.url) {\n    // Try fetch OG image or favicon\n    try {\n      const meta = await fetchSiteHints(input.url);\n      imageDataUrl = meta.logo ?? null;\n    } catch {\n      imageDataUrl = null;\n    }\n  }\n\n  onProgress(25);\n  const palette: PaletteEntry[] = await extractPalette({ imageDataUrl, url: input.url });\n\n  onProgress(55);\n  const fonts: { primary: FontRef; secondary?: FontRef } = await identifyFonts({ imageDataUrl, url: input.url });\n\n  onProgress(75);\n  const tone = await inferTone({ url: input.url, handle: input.handle });\n  const _styleTokens = mapToneToStyle(tone);\n\n  const kit: BrandKit = { palette, fonts, tone, logo: imageDataUrl ? { url: imageDataUrl } : undefined };\n\n  onProgress(85);\n  const previews = createPreviews(kit);\n  const a11y = buildA11yPanel(kit);\n  onProgress(100);\n  return { kit, renders: { previews, a11y } };\n}\n\nasync function fetchSiteHints(url: string): Promise<{ logo?: string; themeColor?: string; fonts?: string[] }> {\n  // Call server to avoid CORS and parse site content\n  const resp = await fetch(`/api/hints?url=${encodeURIComponent(url)}`);\n  if (!resp.ok) throw new Error('Failed to fetch site hints');\n  return await resp.json();\n}\n\nfunction fileToDataUrl(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = () => reject(reader.error);\n    reader.onload = () => resolve(String(reader.result));\n    reader.readAsDataURL(file);\n  });\n}\n\n","import { initializeThemeSync, requestDocumentApply } from './sdk/ui.js';\nimport { analyzeBrandInputs } from './ui/app.js';\nimport { type BrandKit } from './state/types.js';\n\ninitializeThemeSync();\n\nconst appEl = document.getElementById('app')!;\nappEl.setAttribute('aria-busy', 'true');\n\n// Build shell\nappEl.innerHTML = `\n  <div class=\"sba-shell\">\n    <aside class=\"sba-left\" aria-label=\"Input panel\">\n      <div class=\"sba-col\">\n        <label class=\"spectrum-FieldLabel\">Logo image\n          <input id=\"logoFile\" class=\"spectrum-Textfield\" type=\"file\" accept=\"image/*\" />\n        </label>\n        <label class=\"spectrum-FieldLabel\">Website URL\n          <input id=\"siteUrl\" class=\"spectrum-Textfield\" type=\"url\" placeholder=\"https://example.com\" />\n        </label>\n        <label class=\"spectrum-FieldLabel\">Social handle\n          <input id=\"social\" class=\"spectrum-Textfield\" type=\"text\" placeholder=\"@brand\" />\n        </label>\n        <button id=\"analyzeBtn\" class=\"spectrum-Button spectrum-Button--cta\"><span class=\"spectrum-Button-label\">Analyze Brand</span></button>\n        <div id=\"status\" role=\"status\" aria-live=\"polite\"></div>\n        <progress id=\"progress\" class=\"spectrum-ProgressBar\" max=\"100\" value=\"0\" aria-label=\"Analysis progress\"></progress>\n        <button id=\"saveApply\" class=\"spectrum-Button\" disabled><span class=\"spectrum-Button-label\">One-click Brand Kit</span></button>\n      </div>\n    </aside>\n    <main id=\"main\" class=\"sba-right\" tabindex=\"-1\">\n      <div class=\"spectrum-Tabs\" role=\"tablist\" aria-label=\"Results tabs\">\n        <button class=\"spectrum-Tabs-item is-selected\" role=\"tab\" aria-selected=\"true\" data-tab=\"kit\">Brand Kit</button>\n        <button class=\"spectrum-Tabs-item\" role=\"tab\" aria-selected=\"false\" data-tab=\"preview\">Mood Preview</button>\n        <button class=\"spectrum-Tabs-item\" role=\"tab\" aria-selected=\"false\" data-tab=\"templates\">Templates</button>\n        <button class=\"spectrum-Tabs-item\" role=\"tab\" aria-selected=\"false\" data-tab=\"a11y\">Accessibility</button>\n      </div>\n      <section id=\"panel-kit\" class=\"tab-panels\"></section>\n      <section id=\"panel-preview\" class=\"tab-panels\" hidden></section>\n      <section id=\"panel-templates\" class=\"tab-panels\" hidden></section>\n      <section id=\"panel-a11y\" class=\"tab-panels\" hidden></section>\n    </main>\n  </div>\n`;\n\nappEl.setAttribute('aria-busy', 'false');\n\n// Tabs\nconst tabs = Array.from(document.querySelectorAll('.spectrum-Tabs-item')) as HTMLButtonElement[];\ntabs.forEach(tab => {\n  tab.addEventListener('click', () => {\n    tabs.forEach(t => { t.classList.remove('is-selected'); t.setAttribute('aria-selected', 'false'); });\n    tab.classList.add('is-selected');\n    tab.setAttribute('aria-selected', 'true');\n    const selected = tab.dataset.tab;\n    document.querySelectorAll('.tab-panels').forEach(p => (p as HTMLElement).hidden = true);\n    document.getElementById(`panel-${selected}`)!.hidden = false;\n    (document.getElementById('main') as HTMLElement).focus();\n  });\n});\n\n// Analyze\nconst analyzeBtn = document.getElementById('analyzeBtn') as HTMLButtonElement;\nconst saveApplyBtn = document.getElementById('saveApply') as HTMLButtonElement;\nconst statusEl = document.getElementById('status')!;\nconst progressEl = document.getElementById('progress') as HTMLProgressElement;\n\nlet currentKit: BrandKit | null = null;\n\nanalyzeBtn.addEventListener('click', async () => {\n  analyzeBtn.disabled = true;\n  statusEl.textContent = 'Analyzingâ€¦';\n  progressEl.value = 5;\n  try {\n    const file = (document.getElementById('logoFile') as HTMLInputElement).files?.[0] ?? null;\n    const url = (document.getElementById('siteUrl') as HTMLInputElement).value || null;\n    const handle = (document.getElementById('social') as HTMLInputElement).value || null;\n    const { kit, renders } = await analyzeBrandInputs({ file, url, handle, onProgress: v => progressEl.value = v });\n    currentKit = kit;\n    saveApplyBtn.disabled = false;\n    statusEl.textContent = 'Analysis complete.';\n    renderResults(kit, renders);\n    document.querySelector('[data-tab=\"kit\"]')?.dispatchEvent(new Event('click'));\n  } catch (e) {\n    console.error(e);\n    statusEl.textContent = 'Analysis failed. Check inputs or try mock mode.';\n  } finally {\n    analyzeBtn.disabled = false;\n    progressEl.value = 0;\n  }\n});\n\nsaveApplyBtn.addEventListener('click', async () => {\n  if (!currentKit) return;\n  statusEl.textContent = 'Applying Brand Kit to documentâ€¦';\n  try {\n    await requestDocumentApply(currentKit);\n    statusEl.textContent = 'Brand Kit applied.';\n  } catch (e) {\n    console.error(e);\n    statusEl.textContent = 'Failed to apply in the editor.';\n  }\n});\n\nfunction renderResults(kit: BrandKit, renders: { previews: HTMLDivElement[]; a11y: HTMLElement }) {\n  const kitPanel = document.getElementById('panel-kit')!;\n  kitPanel.innerHTML = '';\n  const palette = document.createElement('div');\n  palette.className = 'palette-grid';\n  for (const sw of kit.palette) {\n    const chip = document.createElement('div');\n    chip.className = 'swatch';\n    chip.style.background = sw.hex;\n    chip.title = `${sw.role}: ${sw.hex}`;\n    palette.appendChild(chip);\n  }\n  const type = document.createElement('div');\n  type.innerHTML = `<div>Primary font: <strong>${kit.fonts.primary.family}</strong></div>` +\n                   (kit.fonts.secondary ? `<div>Secondary font: <strong>${kit.fonts.secondary.family}</strong></div>` : '') +\n                   `<div>Tone: ${kit.tone}</div>`;\n  kitPanel.append(palette, type);\n\n  const previewPanel = document.getElementById('panel-preview')!;\n  previewPanel.innerHTML = '';\n  renders.previews.forEach(p => previewPanel.appendChild(p));\n\n  const a11yPanel = document.getElementById('panel-a11y')!;\n  a11yPanel.innerHTML = '';\n  a11yPanel.appendChild(renders.a11y);\n}\n\n"],"names":["initializeThemeSync","mq","applyTheme","dark","html","e","requestDocumentApply","kit","correlationId","resolve","reject","onMessage","ev","data","extractPalette","input","normalizeRoles","swatches","roles","s","i","identifyFonts","_input","inferTone","normalizeTone","v","contrastRatio","hexA","hexB","L1","relativeLuminance","hexToRgb","L2","lighter","darker","ensureAA","fg","bg","fgRgb","bgRgb","fgIsLight","adjusted","rgbToHex","darken","lighten","hex","h","c","num","rgb","toHex","clamp","n","r","g","b","srgb","R","G","B","amt","buildA11yPanel","container","table","header","textColors","p","bgColors","ratio","tr","aa","aaa","suggestion","adj","createPreviews","sizes","primary","text","size","el","openBtn","analyzeBrandInputs","onProgress","imageDataUrl","fileToDataUrl","fetchSiteHints","palette","fonts","tone","previews","a11y","url","resp","file","reader","appEl","tabs","tab","t","selected","analyzeBtn","saveApplyBtn","statusEl","progressEl","currentKit","handle","renders","renderResults","kitPanel","sw","chip","type","previewPanel","a11yPanel"],"mappings":"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"}