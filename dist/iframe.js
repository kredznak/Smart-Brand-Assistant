function $(){const e=window.matchMedia("(prefers-color-scheme: dark)");function t(n){const a=document.documentElement;a.classList.toggle("spectrum--dark",n),a.classList.toggle("spectrum--light",!n)}t(e.matches),e.addEventListener("change",n=>t(n.matches))}async function F(e){const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`;return new Promise((n,a)=>{function r(o){const s=o.data;!s||typeof s!="object"||s.correlationId===t&&(s.type==="SBA_APPLY_DONE"?(window.removeEventListener("message",r),n()):s.type==="SBA_APPLY_ERROR"&&(window.removeEventListener("message",r),a(new Error(String(s.error)))))}window.addEventListener("message",r),window.parent.postMessage({type:"SBA_APPLY_BRAND_KIT",payload:e,correlationId:t},"*")})}async function P(e){if(e.url)try{const n=await(await fetch("/api/analyze/colors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e.url})})).json();if(Array.isArray(n.swatches))return A(n.swatches)}catch{}return A([{name:"Primary",hex:"#0A84FF",role:"primary"},{name:"Secondary",hex:"#34C759",role:"secondary"},{name:"Accent",hex:"#FF9500",role:"accent"},{name:"Background",hex:"#FFFFFF",role:"bg"},{name:"Surface",hex:"#F2F2F7",role:"surface"},{name:"Text",hex:"#111111",role:"text"}])}function A(e){const t=["primary","secondary","accent","bg","surface","text"];return e.slice(0,8).map((n,a)=>({name:String(n.name??`Color ${a+1}`),hex:String(n.hex??n.color??"#888888").toUpperCase(),role:n.role??t[Math.min(a,t.length-1)]}))}async function I(e){try{const n=await(await fetch("/api/analyze/fonts",{method:"POST"})).json();if(n?.primary)return{primary:n.primary,secondary:n.options?.[1]}}catch{}return{primary:{family:"Inter",source:"google-fonts",weights:[400,600]},secondary:{family:"Roboto",source:"google-fonts",weights:[400,700]}}}async function S(e){try{const n=await(await fetch("/api/analyze/tone",{method:"POST"})).json();return C(String(n?.tone??"friendly"))}catch{return"friendly"}}function C(e){return{friendly:"friendly",bold:"bold",minimal:"minimal",playful:"playful",professional:"professional"}[e.toLowerCase()]??"friendly"}function d(e,t){const n=p(u(e)),a=p(u(t)),[r,o]=n>a?[n,a]:[a,n];return(r+.05)/(o+.05)}function M(e,t){if(d(e,t)>=4.5)return{fg:e,bg:t,passes:!0};const a=u(e),r=u(t),o=p(a)>p(r);let s=a;for(let l=0;l<20&&d(y(s),t)<4.5;l++)s=o?R(s,.06):k(s,.06);return{fg:y(s),bg:t,passes:d(y(s),t)>=4.5}}function u(e){const t=e.replace("#",""),n=t.length===3?t.split("").map(r=>r+r).join(""):t,a=parseInt(n,16);return{r:a>>16&255,g:a>>8&255,b:a&255}}function y(e){const t=n=>n.toString(16).padStart(2,"0");return`#${t(f(e.r))}${t(f(e.g))}${t(f(e.b))}`.toUpperCase()}function f(e){return Math.max(0,Math.min(255,Math.round(e)))}function p({r:e,g:t,b:n}){const a=[e,t,n].map(l=>l/255).map(l=>l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4)),[r,o,s]=a;return .2126*r+.7152*o+.0722*s}function k(e,t){return{r:e.r+255*t,g:e.g+255*t,b:e.b+255*t}}function R(e,t){return{r:e.r-255*t,g:e.g-255*t,b:e.b-255*t}}function U(e){const t=document.createElement("div");t.className="sba-col";const n=document.createElement("table");n.className="spectrum-Table";const a=document.createElement("tr");a.innerHTML="<th>Foreground</th><th>Background</th><th>Ratio</th><th>AA</th><th>AAA</th><th>Suggestion</th>",n.appendChild(a);const r=e.palette.filter(s=>["text","primary","secondary"].includes(s.role)),o=e.palette.filter(s=>["bg","surface","primary","secondary"].includes(s.role));for(const s of r)for(const l of o){const i=d(s.hex,l.hex),m=document.createElement("tr"),v=i>=4.5,T=i>=7;let x="";if(!v){const E=M(s.hex,l.hex);x=`${E.fg} / ${E.bg}`}m.innerHTML=`<td><span class="swatch" style="background:${s.hex}"></span> ${s.hex}</td><td><span class="swatch" style="background:${l.hex}"></span> ${l.hex}</td><td>${i.toFixed(2)}</td><td>${v?"Pass":"Fail"}</td><td>${T?"Pass":"—"}</td><td>${x}</td>`,n.appendChild(m)}return t.appendChild(n),t}function H(e){const t=[{name:"IG Post",w:1080,h:1080},{name:"IG Story",w:1080,h:1920},{name:"Flyer",w:816,h:1056},{name:"Email Header",w:1200,h:400},{name:"Presentation",w:1920,h:1080}],n=e.palette.find(r=>r.role==="primary")?.hex??"#0A84FF",a=e.palette.find(r=>r.role==="text")?.hex??"#111111";return t.map(r=>{const o=document.createElement("div");o.className="sba-col",o.style.border="1px solid var(--spectrum-global-color-gray-300)",o.style.padding="8px",o.innerHTML=`<div style="width:100%; aspect-ratio:${r.w}/${r.h}; background:${n}; color:${a}; display:flex; align-items:center; justify-content:center; font-family:${e.fonts.primary.family}">${r.name}</div>`;const s=document.createElement("button");return s.className="spectrum-Button",s.innerHTML='<span class="spectrum-Button-label">Open in Editor</span>',s.addEventListener("click",()=>{window.alert(`${r.name} would open in the editor.`)}),o.appendChild(s),o})}async function j(e){const t=e.onProgress??(()=>{});t(10);let n=null;if(e.file)n=await D(e.file);else if(e.url)try{n=(await z(e.url)).logo??null}catch{n=null}t(25);const a=await P({imageDataUrl:n,url:e.url});t(55);const r=await I();t(75);const o=await S(),s={palette:a,fonts:r,tone:o,logo:n?{url:n}:void 0};t(85);const l=H(s),i=U(s);return t(100),{kit:s,renders:{previews:l,a11y:i}}}async function z(e){const t=await fetch(`/api/hints?url=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to fetch site hints");return await t.json()}function D(e){return new Promise((t,n)=>{const a=new FileReader;a.onerror=()=>n(a.error),a.onload=()=>t(String(a.result)),a.readAsDataURL(e)})}$();const w=document.getElementById("app");w.setAttribute("aria-busy","true");w.innerHTML=`
  <div class="sba-shell">
    <aside class="sba-left" aria-label="Input panel">
      <div class="sba-col">
        <label class="spectrum-FieldLabel">Logo image
          <input id="logoFile" class="spectrum-Textfield" type="file" accept="image/*" />
        </label>
        <label class="spectrum-FieldLabel">Website URL
          <input id="siteUrl" class="spectrum-Textfield" type="url" placeholder="https://example.com" />
        </label>
        <label class="spectrum-FieldLabel">Social handle
          <input id="social" class="spectrum-Textfield" type="text" placeholder="@brand" />
        </label>
        <button id="analyzeBtn" class="spectrum-Button spectrum-Button--cta"><span class="spectrum-Button-label">Analyze Brand</span></button>
        <div id="status" role="status" aria-live="polite"></div>
        <progress id="progress" class="spectrum-ProgressBar" max="100" value="0" aria-label="Analysis progress"></progress>
        <button id="saveApply" class="spectrum-Button" disabled><span class="spectrum-Button-label">One-click Brand Kit</span></button>
      </div>
    </aside>
    <main id="main" class="sba-right" tabindex="-1">
      <div class="spectrum-Tabs" role="tablist" aria-label="Results tabs">
        <button class="spectrum-Tabs-item is-selected" role="tab" aria-selected="true" data-tab="kit">Brand Kit</button>
        <button class="spectrum-Tabs-item" role="tab" aria-selected="false" data-tab="preview">Mood Preview</button>
        <button class="spectrum-Tabs-item" role="tab" aria-selected="false" data-tab="templates">Templates</button>
        <button class="spectrum-Tabs-item" role="tab" aria-selected="false" data-tab="a11y">Accessibility</button>
      </div>
      <section id="panel-kit" class="tab-panels"></section>
      <section id="panel-preview" class="tab-panels" hidden></section>
      <section id="panel-templates" class="tab-panels" hidden></section>
      <section id="panel-a11y" class="tab-panels" hidden></section>
    </main>
  </div>
`;w.setAttribute("aria-busy","false");const B=Array.from(document.querySelectorAll(".spectrum-Tabs-item"));B.forEach(e=>{e.addEventListener("click",()=>{B.forEach(n=>{n.classList.remove("is-selected"),n.setAttribute("aria-selected","false")}),e.classList.add("is-selected"),e.setAttribute("aria-selected","true");const t=e.dataset.tab;document.querySelectorAll(".tab-panels").forEach(n=>n.hidden=!0),document.getElementById(`panel-${t}`).hidden=!1,document.getElementById("main").focus()})});const h=document.getElementById("analyzeBtn"),L=document.getElementById("saveApply"),c=document.getElementById("status"),g=document.getElementById("progress");let b=null;h.addEventListener("click",async()=>{h.disabled=!0,c.textContent="Analyzing…",g.value=5;try{const e=document.getElementById("logoFile").files?.[0]??null,t=document.getElementById("siteUrl").value||null,n=document.getElementById("social").value||null,{kit:a,renders:r}=await j({file:e,url:t,handle:n,onProgress:o=>g.value=o});b=a,L.disabled=!1,c.textContent="Analysis complete.",N(a,r),document.querySelector('[data-tab="kit"]')?.dispatchEvent(new Event("click"))}catch(e){console.error(e),c.textContent="Analysis failed. Check inputs or try mock mode."}finally{h.disabled=!1,g.value=0}});L.addEventListener("click",async()=>{if(b){c.textContent="Applying Brand Kit to document…";try{await F(b),c.textContent="Brand Kit applied."}catch(e){console.error(e),c.textContent="Failed to apply in the editor."}}});function N(e,t){const n=document.getElementById("panel-kit");n.innerHTML="";const a=document.createElement("div");a.className="palette-grid";for(const l of e.palette){const i=document.createElement("div");i.className="swatch",i.style.background=l.hex,i.title=`${l.role}: ${l.hex}`,a.appendChild(i)}const r=document.createElement("div");r.innerHTML=`<div>Primary font: <strong>${e.fonts.primary.family}</strong></div>`+(e.fonts.secondary?`<div>Secondary font: <strong>${e.fonts.secondary.family}</strong></div>`:"")+`<div>Tone: ${e.tone}</div>`,n.append(a,r);const o=document.getElementById("panel-preview");o.innerHTML="",t.previews.forEach(l=>o.appendChild(l));const s=document.getElementById("panel-a11y");s.innerHTML="",s.appendChild(t.a11y)}
//# sourceMappingURL=iframe.js.map
